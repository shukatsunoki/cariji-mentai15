<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4f46e5">
    <meta name="description" content="キャリ爺とAIお助けマンと進める15日間の面接道場">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>面接対策 15日間プログラム</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #334155;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
            display: flex;
            gap: 20px;
        }

        .card {
            background-color: white;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 20px;
            width: 100%;
        }

        aside {
            position: sticky;
            top: 20px;
            height: fit-content;
            width: 250px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        aside ul li {
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 0.5rem;
            transition: background-color 0.2s, color 0.2s;
            color: #334155;
            font-size: 0.9rem;
        }

        aside ul li:hover {
            background-color: #e0e7ff;
        }
        
        aside ul li.active-day {
            background-color: #c7d2fe;
            font-weight: 600;
        }

        .nav-tab {
            padding: 12px;
            border-radius: 0.75rem;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s, color 0.2s;
            text-align: center;
        }

        .nav-tab.active {
            background-color: #4f46e5;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .nav-tab:not(.active) {
            background-color: #eef2ff;
            color: #4f46e5;
        }
        
        #category-filter-nav {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
            padding: 10px;
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .category-button {
            padding: 8px 12px;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: opacity 0.2s, transform 0.2s;
            text-align: center;
        }

        .category-button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .category-button[data-category="core"] {
            background-color: #ef4444;
            color: white;
        }
        .category-button[data-category="key"] {
            background-color: #f97316;
            color: white;
        }
        .category-button[data-category="good"] {
            background-color: #22c55e;
            color: white;
        }

        /* --- ★キャラクター・吹き出し用スタイル★ --- */
        .chara-container {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 1.5rem;
        }

        .chara-icon {
            flex-shrink: 0;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem; /* アイコンのサイズ */
            border-width: 3px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        /* キャリ爺のアイコン色 */
        .chara-kyarijii {
            background-color: #eef2ff;
            color: #4f46e5;
            border-color: #c7d2fe;
        }
        
        /* AIお助けマンのアイコン色 */
        .chara-ai {
            background-color: #dbeafe;
            color: #3b82f6;
            border-color: #bfdbfe;
            font-size: 2rem; /* ロボットアイコンの調整 */
        }


        .balloon {
            position: relative;
            flex-grow: 1;
            padding: 1rem 1.25rem;
            border-radius: 45% 55% 60% 40% / 40% 40% 60% 60%; /* ★雲・波線風の歪んだ角丸★ */
            background-color: #f3f4f6;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            min-height: 64px; /* アイコンの高さと合わせる */
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* 吹き出しの「しっぽ」 */
        .balloon::before {
            content: '';
            position: absolute;
            left: -12px;
            top: 20px; /* アイコンの中央あたり */
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 12px solid #f3f4f6;
            /* 歪みに合わせてしっぽも少し傾ける */
            transform: rotate(-5deg);
        }

        /* 各種吹き出しの色の調整 */
        .balloon-think {
            background-color: #fffbeb;
            border-radius: 55% 45% 40% 60% / 40% 60% 40% 60%;
        }
        .balloon-think::before { background-color: #fffbeb; }
        
        .balloon-example {
            background-color: #fefbec;
            border-radius: 40% 60% 50% 50% / 50% 40% 60% 50%;
        }
        .balloon-example::before { border-right-color: #fefbec; }

        .balloon-ai {
            background-color: #f0f9ff;
            border-radius: 60% 40% 55% 45% / 45% 55% 40% 60%;
        }
        .balloon-ai::before { border-right-color: #f0f9ff; }


        .balloon-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: #4f46e5; /* キャリ爺のテーマカラー */
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .balloon-title-think { color: #ca8a04; }
        .balloon-title-example { color: #b45309; }
        .balloon-title-ai { color: #2563eb; }
        /* --- ★ここまで★ --- */


        /* --- ★成長ビジュアル用スタイル★ --- */
        #growth-icon {
            transition: transform 0.5s ease-in-out;
        }
        /* --- ★ここまで★ --- */


        /* --- ★ナビゲーションメニューの完了状態★ --- */
        aside ul li.day-complete {
            color: #16a34a; /* green-600 */
            font-weight: 600;
        }
        aside ul li .completion-icon {
            margin-right: 8px;
            color: #22c55e; /* green-500 */
        }
        /* --- ★ここまで★ --- */


        /* --- ★★★【追加】通常モード用CSS ★★★ --- */
        /* 通常モードが選択された際、キャリ爺の吹き出し関連を非表示にする */
        body.normal-mode .chara-container {
            display: none;
        }
        body.normal-mode .balloon {
            display: none;
        }
        /* --- ★★★ ここまで ★★★ */


        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                flex-direction: column;
                gap: 10px;
            }
            aside {
                position: static;
                width: 100%;
                order: -1;
            }
            #nav-tabs-container {
                display: flex;
                flex-direction: row;
                gap: 10px;
            }
            .nav-tab {
                flex: 1;
            }
            #category-filter-nav {
                flex-direction: row;
                justify-content: space-around;
                width: 100%;
                padding: 8px;
            }
            
            /* スマホ用にアイコンと吹き出しのサイズ調整 */
            .chara-icon {
                width: 48px;
                height: 48px;
                font-size: 1.5rem;
            }
            .chara-ai { font-size: 1.4rem; }
            
            .balloon {
                padding: 0.75rem 1rem;
                min-height: 48px;
            }
            .balloon::before {
                top: 12px;
                border-top-width: 8px;
                border-bottom-width: 8px;
                border-right-width: 10px;
                left: -10px;
            }
            
            /* 成長ビジュアルのスマホ調整 */
            #growth-icon {
                font-size: 2.5rem; /* 少し小さく */
            }
            #growth-text {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>

    <div id="mode-select-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex justify-center items-center z-50">
        <div class="bg-white p-8 rounded-2xl shadow-2xl text-center max-w-lg mx-4">
            <h2 class="text-3xl font-bold text-indigo-700 mb-4">ようこそ！</h2>
            <p class="text-gray-600 mb-8 text-lg">どちらの音声ガイドで学習を始めますか？</p>
            <div class="flex flex-col sm:flex-row gap-6">
                <button id="select-kyarijii" class="flex-1 p-6 bg-indigo-50 hover:bg-indigo-100 border-2 border-indigo-200 rounded-xl transition transform hover:scale-105">
                    <div class="text-5xl mb-3">👴</div>
                    <h3 class="text-xl font-bold text-indigo-600">キャリ爺 (笑) パターン</h3>
                    <p class="text-gray-500 mt-1">キャリ爺がコミカルにガイドするんじゃ！</p>
                </button>
                <button id="select-normal" class="flex-1 p-6 bg-gray-50 hover:bg-gray-100 border-2 border-gray-200 rounded-xl transition transform hover:scale-105">
                    <div class="text-5xl mb-3">👩‍🏫</div>
                    <h3 class="text-xl font-bold text-gray-700">通常パターン</h3>
                    <p class="text-gray-500 mt-1">標準的な音声で真面目に学習します。</p>
                </button>
            </div>
        </div>
    </div>
    <audio id="intro-audio"></audio>
    <audio id="main-audio"></audio>
    
    <!-- 修正: 外部ファイル依存のアラート音を削除 -->
    <!-- <audio id="timer-alert-audio" src="timer_alert.mp3" preload="auto"></audio> -->
    <div class="container">
        
        <aside>
            <div id="nav-tabs-container" class="bg-white p-3 rounded-xl shadow-lg flex flex-col gap-2">
                <div id="tab-daily" class="nav-tab active">
                    <i class="fas fa-calendar-alt mr-2"></i> 日数スケジュール版
                </div>
                <div id="tab-category" class="nav-tab">
                    <i class="fas fa-layer-group mr-2"></i> 重要度別版
                </div>
            </div>

            <div id="category-filter-nav" class="hidden">
                <div class="category-button" data-category="core">最重要 (Core)</div>
                <div class="category-button" data-category="key">重要 (Key)</div>
                <div class="category-button" data-category="good">準備しておくと良い (Good)</div>
            </div>

            <div id="list-daily-container" class="card p-4">
                <ul id="questions-list-daily" class="space-y-1">
                </ul>
            </div>

            <div id="list-category-container" class="card p-4 hidden">
                <div class="space-y-2">
                    <h3 class="text-lg font-semibold text-red-600">最重要 (Core)</h3>
                    <ul id="questions-list-core" class="space-y-1"></ul>
                </div>
                <div class="space-y-2 mt-4">
                    <h3 class="text-lg font-semibold text-orange-600">重要 (Key)</h3>
                    <ul id="questions-list-key" class="space-y-1"></ul>
                </div>
                <div class="space-y-2 mt-4">
                    <h3 class="text-lg font-semibold text-green-600">準備しておくと良い (Good)</h3>
                    <ul id="questions-list-good" class="space-y-1"></ul>
                </div>
            </div>
        </aside>

        <main class="w-full">
            <header class="card text-center">
                <h1 class="text-3xl font-bold text-indigo-700"></h1>
                <p class="text-gray-500 mt-1"></p>
                
                <div class="mt-4 flex flex-col items-center">
                    <h2 class="text-xl font-semibold mb-2">
                        音声ガイド(はじめに)
                        <br>
                        <span id="audio-warning" class="hidden" style="color: blue;">
                            ★<span style="color: red;">注意</span>★
                            各日程の音声ガイドを再生する場合は、この説明音声を
                            <span style="color: red;">stop</span>
                            するんじゃぞ。★
                        </span>
                    </h2>
                    <div class="flex items-center gap-4">
                        <button id="play-intro" class="bg-indigo-500 hover:bg-indigo-600 text-white p-3 rounded-full transition duration-150 shadow-md">
                            <i class="fas fa-play"></i>
                        </button>
                        
                        <div id="intro-speed-controls" class="flex gap-1 text-sm bg-gray-100 p-1 rounded-full">
                            <button data-speed="0.8" class="speed-btn py-1 px-3 rounded-full text-gray-600 hover:bg-white transition duration-150">0.8x</button>
                            <button data-speed="1.0" class="speed-btn py-1 px-3 rounded-full bg-white text-indigo-600 font-bold shadow-sm transition duration-150">1.0x</button>
                            <button data-speed="1.2" class="speed-btn py-1 px-3 rounded-full text-gray-600 hover:bg-white transition duration-150">1.2x</button>
                            <button data-speed="1.5" class="speed-btn py-1 px-3 rounded-full text-gray-600 hover:bg-white transition duration-150">1.5x</button>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 border-t pt-5">
                    <h2 class="text-xl font-semibold mb-2 text-blue-600">
                        <i class="fas fa-random"></i> 実践！模擬面接モード・１５日間の対策をおえたらチャレンジ
                    </h2>
                    <p class="text-gray-500 text-sm mb-4" id="practice-description">
                        準備ができたら、ランダムな質問（全3問）で本番の練習をするんじゃ！
                    </p>
                    <button id="start-practice-mode" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition duration-150 shadow-md text-lg">
                        実践練習をスタート
                    </button>
                </div>
            </header>
            
            <div class="card p-3">
                <h2 class="text-lg font-semibold mb-2">修行の進捗</h2>
                <div class="h-2 bg-gray-200 rounded-full">
                    <div id="progress-bar-fill" class="h-2 bg-green-500 rounded-full transition-all duration-500" style="width: 0%;"></div>
                </div>
                <p id="progress-text" class="text-right text-sm text-gray-500 mt-1">0/15 日完了</p>
                
                <div class="mt-4 flex items-center gap-4 p-3 bg-green-50 rounded-lg border border-green-200">
                    <div id="growth-icon" class="text-5xl">🌱</div>
                    <div>
                        <p id="growth-text" class="text-gray-700 font-semibold"></p>
                        <p class="text-sm text-gray-500">（進捗: <span id="progress-percent">0</span>%）</p>
                    </div>
                </div>

                <!-- ★★★ 追加: 進捗リセットボタン ★★★ -->
                <div class="mt-6 pt-4 border-t border-gray-200 text-center">
                    <button id="reset-data-button" class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-lg transition duration-150 shadow-sm text-sm">
                        <i class="fas fa-trash-alt mr-2"></i> 進捗データをリセット
                    </button>
                </div>
                <!-- ★★★ ここまで ★★★ -->
            </div>

            <div id="content-container">
            </div>
        </main>
    </div>

<script>
let currentAudioMode = 'kyarijii';

// Web Audio APIのコンテキストを初期化
const audioContext = new (window.AudioContext || window.webkitAudioContext)();

// ★★★【追加】実践練習モード用のグローバル変数 ★★★
let practiceQuestions = [];
let currentPracticeIndex = 0;
let practiceTimerInterval = null;
let practiceTimerSeconds = 60;
// 質問の対象日 (Day 13:逆質問, Day 15:振り返り を除外)
const practiceQuestionPool = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14];
// ★★★ ここまで ★★★

// ★★★【追加】実践練習モード用のDOM参照 ★★★
// (DOMContentLoaded内で定義されるため、ここでは宣言しない)
let startPracticeBtn, practiceModal, practiceQuestionCount, practiceQuestionTitle;
let practiceTimer, practiceTimerBar, stopPracticeBtn, nextPracticeBtn;
// 修正: timerAlertAudio を削除

// ★★★ `example_detailed` のデータをすべて復元（Day 4を改善） ★★★
const questionsData = {
    0: {
        title: "はじめに (プログラム紹介)",
        audio_sources: {
            kyarijii: "introduction.mp3",
            normal: "introduction_normal.mp3"
        }
    },
    1: {
        title: "#1日目# 自己紹介をお願いします",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "今日は初日じゃな。面接の第一歩、「自己紹介」にチャレンジしてみよう！",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "面接官はなぜ、最初に「自己紹介」を求めるんじゃと思うか？<br>...そうじゃな。君が「どんな人物か」をアイスブレイクしながら知りたい、という意図があるんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "面接の第一印象を決める重要な質問。簡潔に、しかし熱意が伝わるように話す。",
        points: ["氏名、学歴/職歴、応募職種と一言でのPRを30秒〜1分程度にまとめる。", "話す内容は志望動機や自己PRに繋がるよう意識する。", "笑顔でハキハキと話す。"],
        example_simple: "〇〇大学から参りました△△です。学生時代はサークル活動で課題解決に取り組み、チームを牽引しました。本日はよろしくお願いいたします。",
        example_detailed: {
            '自己紹介パターン': "〇〇大学の△△です。学生時代は特に、サークル活動を通じて培った「目標達成に向けた粘り強さ」が強みです。貴社が掲げる「顧客第一」の理念に共感し、この強みをもって貢献したいと考えています。本日は短い時間ですが、よろしくお願いいたします。",
            '職種特化パターン': "〇〇大学から参りました△△です。大学ではデータサイエンスを専攻し、特にPythonを用いた分析スキルに自信があります。貴社のマーケティング部門でのデータドリブンな意思決定に貢献できると考え、志望いたしました。どうぞよろしくお願いいたします。"
        },
        checklist: ["時間内に収まるか確認した", "結論から述べられているか確認した", "入社意欲が伝わるか確認した"],
        prompt_focus: "【自己紹介へのフィードバック依頼】\n[質問: 自己紹介をお願いします]\n\n以下の私の回答に対して、面接官がさらに深掘りしたくなるような「キーワード」が含まれているか、また、回答が簡潔で分かりやすいかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day1_guidance.mp3",
            normal: "day1_normal.mp3"
        }
    },
    2: {
        title: "#2日目# 学生時代に最も打ち込んだことは何ですか?",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "2日目じゃな。今日は面接の「華」とも言える質問、『ガクチカ』じゃ！",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "面接官はなぜ、君の『打ち込んだこと』を知りたいんじゃ？<br>...そうじゃ！君が目標に対して『どう考え、どう行動したか』、その『本気』のプロセスを知りたいからなんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "通称「ガクチカ」。目標設定、課題、行動、結果を通じて、あなたの行動特性や価値観を問う。",
        points: ["なぜそれを始めたかという動機を明確にする。", "直面した課題や困難を具体的に述べる。", "その課題に対して自分がどのような「行動」をとったかを具体的に説明する。"],
        example_simple: "大学のテニスサークルで部長を務め、部員数の減少という課題に対し、体験会の改善に取り組みました。",
        example_detailed: {
            "サークル・部活パターン": "テニスサークルでの部長経験です。**[状況]** 創立以来の課題であった練習への参加率低下(前年度比-40%)に直面しました。**[課題]** 私は練習の魅力向上を最優先課題とし、**[行動]** 部員一人ひとりに非公式な面談(約50名)を実施し、「練習内容のマンネリ化と初心者への配慮不足」が原因だと特定。上級生・下級生混合の指導チームを結成し、レベル別・目標別のメニューを導入しました。**[結果]** その結果、3ヶ月で練習への参加率を**30%改善**し、サークルの雰囲気も活発になりました。",
            "アルバイトパターン": "地域密着型カフェでのアルバイト経験です。**[状況]** 土日のピークタイムには、オーダーミスやレジの混雑による客様の待ち時間が常態化していました。**[課題]** 顧客満足度向上を目指し、特に会計時のボトルネック解消に注力しました。**[行動]** 私は従業員の動線を分析し、既存のレジを活かしつつも、「オーダー専用タブレットの導入」と、「会計後回しシステム(提供後にテーブルで会計)」を提案・導入しました。さらに全従業員へのOJT研修マニュアルを作成しました。**[結果]** ピークタイムの待ち時間を平均**5分から2.5分に短縮**し、お客様アンケートでの満足度評価が**15ポイント上昇**しました。",
            "学業・研究パターン": "所属研究室での卒業研究です。**[状況]** 「次世代リチウムイオン電池の電極材料の劣化メカニズム解析」という難解なテーマに取り組みました。**[課題]** 当初、前例のない新規解析手法を確立する必要があり、既存の先行研究だけでは打開策が見つからず研究が停滞しました。**[行動]** 指導教員だけでなく、分野の異なる**他大学の権威ある教授**にメールで意見を求め、**外部セミナーへ積極的に参加**して知見を広げました。また、データの再現性にこだわり、粘り強くシミュレーションと実験を**100回以上**繰り返しました。**[結果]** 結果的に、従来の**5分の1の時間で劣化度を測定できる新しい分析手法を確立**し、学会でポスター発表を行うことができました。",
            "ボランティアパターン": "地域NPO法人での子供向け学習支援ボランティアのリーダー経験です。**[状況]** 担当した学習プログラムで、参加している中学生の宿題完了率が非常に低く(平均30%)、学習意欲の低下が見られました。**[課題]** 楽しく継続できる学習環境を作り、宿題完了率を改善することを目指しました。**[行動]** 私は一方的な指導ではなく、中学生自身が「教える側」になる**ピア・サポート制度を提案**し、導入しました。また、進捗を可視化する独自のスタンプラリー制度を考案しました。**[結果]** 制度導入後、中学生のプログラムへの**欠席率が半減**し、3ヶ月で宿題完了率を**85%まで向上**させることができました。",
            "長期インターンパターン": "ITスタートアップ企業でのマーケティング長期インターン経験です。**[状況]** 企業が提供するSaaSプロダクトの新規リード獲得数が伸び悩み、特にWebサイト経由の獲得率が業界平均を下回っていました。**[課題]** WebサイトのCVR(顧客転換率)を改善し、リード獲得数を増やすことにコミットしました。**[行動]** Google Analyticsなどのデータに基づき、ユーザーの離脱ポイントを特定し、ターゲットペルソナに合わせた**LP(ランディングページ)のコピーライティングとUI/UXの改善を提案**しました。また、A/Bテストを週次で実施し、効果測定を行いました。**[結果]** 6ヶ月間のインターン期間で、Webサイト経由のCVRを**約2.5倍に改善**し、月間の新規リード獲得数に貢献しました。"
        },
        checklist: ["時間内に収まるか確認した", "結論から述べられているか確認した", "入社意欲が伝わるか確認した"],
        prompt_focus: "【自己紹介へのフィードバック依頼】\n[質問: 自己紹介をお願いします]\n\n以下の私の回答に対して、面接官がさらに深掘りしたくなるような「キーワード」が含まれているか、また、回答が簡潔で分かりやすいかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day2_guidance.mp3",
            normal: "day2_normal.mp3"
        }
    },
    3: {
        title: "#3日目# あなたの自己PRを教えてください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "3日目じゃな、順調じゃ！今日のテーマは『自己PR』じゃ！",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "『ガクチカ』とどう違うんじゃ？ と思うかもしれんな。<br>...そうじゃ、『自己PR』は君の『強み』そのものに焦点を当てるんじゃ。面接官は君が『入社後にどう活躍してくれるか』を、具体的なエピソードで判断したいんじゃな。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "自分の強みをアピールする。質問の内容がDay2と似ていても、こちらは「強み」そのものに焦点を当てる。",
        points: ["企業の求める人物像と自分の強みを一致させる。", "強みの根拠となるエピソードは一つに絞り、深掘りして説明する。", "単なる能力ではなく、仕事でどう活かせるかを具体的に伝える。"],
        example_simple: "私の強みは、目標達成に向けた「粘り強さ」です。困難な状況でも諦めずに目標を達成した経験があります。",
        example_detailed: {
            "実行力パターン (主体性)": "私の強みは、常に**「主体性」**を持って行動し、周囲を牽引することです。**[状況]** サークルでイベントの立ち上げ時、誰も手を挙げない中、私は即座に企画書の作成に着手。**[行動]** 企画・予算・人員計画を一手に引き受け、関係各所への交渉を粘り強く行いました。**[結果]** その結果、サークル史上最も大規模なイベントを実現し、参加率を**40%向上**させました。",
            "オペレーション改善パターン (実行力)": "私の強みは、困難な目標に対しても粘り強くやり遂げる**「実行力」**です。**[状況]** 飲食店アルバイトで提供スピード改善という課題に直面。**[行動]** 私はタスクを細分化し、スタッフ一人ひとりの具体的な行動目標とタイムスケジュールを設計し、進捗をグラフで共有し続けました。**[結果]** 3ヶ月でオペレーションの無駄を徹底的に排除し、提供時間を平均**2分短縮**することに成功しました。",
            "研究スケジュール管理パターン (計画力)": "私の強みは、目標から逆算して最適なプロセスを設計する**「計画力」**です。**[状況]** 卒業研究において、複雑な実験が複数絡み合い、期限内に終わらないリスクに直面しました。**[行動]** 私は研究全体を「必須」、「優先」、「予備」に分類し、各フェーズの完了条件とデッドラインを設定し、リソースを動的に再配分しました。**[結果]** スケジュール通りに研究を終え、予備実験まで行う余裕が生まれ、研究の質を向上させることができました。",
            "Web改善パターン (課題発見力)": "私の強みは、現状を深く分析し**「真の課題発見力」**を発揮できることです。**[状況]** 長期インターン先でWebサイトのCVR(顧客転換率)が低いという課題がありましたが、原因が特定できずにいました。**[行動]** 私はアクセスデータからユーザーの離脱ポイントを徹底分析し、ターゲット層のニーズとLPの内容に**ズレがあること**が本質的な原因だと特定しました。**[結果]** ターゲット層に合わせたコピーライティングに改善した結果、**CVRを1.8倍に向上**させました。",
            "イベント企画パターン (創造力)": "私の強みは、既存の枠にとらわれず新しいアイデアを生み出す**「創造力」**です。**[状況]** 大学の文化祭実行委員会で、マンネリ化から来場者数が年々減少していました。**[行動]** 私は従来の展示形式を一新し、地域住民を巻き込んだ**「参加型謎解きイベント」**を企画・提案、実行しました。**[結果]** 結果、学生だけでなく家族連れの来場者が大幅に増加し、前年比**40%増**の集客を達成しました。",
            "チーム内対立解消パターン (傾聴力)": "私の強みは、相手の意見の背景にある真意を汲み取る**「傾聴力」**です。**[状況]** アルバイト先で新商品の販促方法について意見が対立し、チーム内の雰囲気が悪化しました。**[行動]** 私は双方のメンバーに個別で時間を設け、**「なぜその方法が良いのか」という根拠と目的**をひたすら聞くことに徹しました。**[結果]** 共通の目的を確認した上で、双方のメリットを活かした折衷案を提案し、チームの**協力体制を回復**させました。",
            "プレゼン資料作成パターン (発信力)": "私の強みは、相手に応じて内容を整理し、的確に伝える**「発信力」**です。**[状況]** ゼミの共同研究で、複雑な分析結果を専門外のメンバーにも分かりやすく説明する必要がありました。**[行動]** 私は専門用語を避け、具体的な事例や図解を用いて**「中学生にも理解できるレベル」**で資料を再構成しました。**[結果]** メンバー全員が研究内容を深く理解できるようになり、その後の議論が活発化し、研究の質が向上しました。",
            "ルール順守徹底パターン (規律性)": "私の強みは、組織の一員としてルールやモラルを遵守する**「規律性」**です。**[状況]** 塾のアルバイトで、一部講師が独自の指導法や教材を使用し、指導の質にばらつきが生じていました。**[行動]** 私は、生徒の成長という目的のため、マニュアルやルールの重要性を説き、**全講師へのマニュアル遵守の徹底**を呼びかけました。**[結果]** 指導の質が均一化し、生徒や保護者からの**信頼度が向上**しました。",
            "緊急事態対応パターン (柔軟性)": "私の強みは、予期せぬ変化にも冷静に対応できる**「柔軟性」**です。**[状況]** 海外ボランティア活動中、現地での急な天候不良により、計画していた全てのプログラムの実施が不可能になりました。**[行動]** 私はすぐにチームを集め、**「この状況下で何ができるか」**をブレインストーミングし、屋内での文化交流会という代替案を即座に企画・実行しました。**[結果]** 当初の目的とは異なる形で、参加者や現地住民から**高い評価**を得ることができました。",
            "協力体制構築パターン (働きかけ力)": "私の強みは、目標達成のために周囲の協力を引き出す**「働きかけ力」**です。**[状況]** 大学のテニスサークルで、部員間の技術レベルの差が大きく、練習内容に対する不満が高まっていました。**[行動]** 私は、上級生には指導役としての**やりがい**を、初心者には個別指導による**成長機会**というメリットを伝え、レベル別指導チームの結成を働きかけました。**[結果]** メンバー全員が主体的に練習に参加する体制が整い、翌年の新入部員数が**過去最高を記録**しました。",
            "サークル運営パターン (チームワーク)": "私の強みは、多様なメンバーをまとめ、一体感を生み出す**「チームワーク」**です。**[状況]** 学園祭の模擬店運営で、役割分担の意見が対立し、各メンバーが非協力的な態度を取っていました。**[行動]** 私は、対立するメンバーの間に立ち、**「一つの屋台を成功させる」**という共通の目標を何度も再確認させ、個々の役割の重要性を強調しました。**[結果]** 最終的にはチームが一丸となり、過去最高の売上を達成し、**学園祭で表彰**されました。",
            "研究プレッシャー対処パターン (ストレスコントロール力)": "私の強みは、困難な状況でも感情をコントロールし、冷静に対処する**「ストレスコントロール力」**です。**[状況]** 大量の情報と複雑なデータ分析が求められる研究活動において、何度実験を繰り返しても望む結果が出ず、強いプレッシャーを感じました。**[行動]** 私は問題を抱え込まず、**定期的な休息**と**研究室の仲間との雑談**を意識的に取り入れ、客観的な視点を保つよう努めました。**[結果]** 感情的にならずに冷静に分析を続けた結果、わずかな条件設定のミスを発見し、**無事に研究を成功**に導くことができました。",
            "地域貢献パターン (専門知識活用力)": "私の強みは、学んだ専門知識を実社会の課題解決に応用する**「専門知識活用力」**です。**[状況]** 経営学部のゼミで、地域の商店街の活性化プロジェクトに参加しましたが、具体的な施策がデータに基づかない抽象的なものばかりでした。**[行動]** 私はゼミで学んだ**マーケティングの知識**を応用し、顧客動線の調査やアンケートによる**定量的なデータ分析**を実施。そのデータに基づき、効果が予測できる具体的な販促策を提言しました。**[結果]** 商店街の**来客数が10%増加**し、学んだ知識が実際の成果に繋がることを証明できました。"
        },
        checklist: ["強みを一つに絞れた", "強みとエピソードに一貫性がある", "入社後の貢献イメージを明確にした"],
        prompt_focus: "【自己PRへのフィードバック依頼】\n[質問: あなたの自己PRを教えてください]\n\n以下の私の回答に対して、強みの具体性、説得力、そしてそれが応募企業の業務でどのように活かせるかの結びつきについて、面接官視点でのフィードバックをください。",
        audio_sources: {
            kyarijii: "day3_guidance.mp3",
            normal: "day3_normal.mp3"
        }
    },
    4: {
        title: "#4日目# 志望動機を教えてください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "4日目じゃ。さあ、ここが一つ目の山場じゃぞ。今日のテーマは、『志望動機』じゃ！",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "これは、面接官が『なぜ、数ある会社の中でウチを選んだんだ？』という問いに答える、最も重要な質問の一つじゃ。<br>君の『熱意』と、会社への『理解度』が本物かどうかを見極めようとしておる。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "企業の理念、事業、職種への理解度と熱意を測る質問。なぜ「この会社」なのかを明確に。",
        points: ["競合他社ではなく、なぜこの会社なのかを明確にする。", "企業のミッションやバリューに共感する点を具体的に述べる。", "入社後に自分がどう貢献できるか、キャリアプランと結びつける。"],
        example_simple: "貴社の「〇〇を通じて社会に貢献する」という理念に強く共感し、私の△△というスキルを活かして貢献したいと考えております。",
        example_detailed: {
            // ★★★ 志望動機の回答例を大幅に強化 ★★★
            '市場の課題解決型パターン': "**[結論]** 私は、貴社が掲げる『情報格差をゼロにする』というミッションに、学生時代に培った『課題発見力』を活かし貢献したいと考え志望いたしました。**[Why Industry]** 私は長期インターンで、地方におけるデジタルサービスの浸透の遅れを目の当たりにし、この社会課題の解決に人生を費やしたいと決意しました。**[Why Company]** 数多くの企業の中で、貴社は唯一、**地域特化型のDX支援サービス**に注力されており、その事業戦略に強く共感しております。**[How I Contribute]** 私の強みである、顧客の潜在ニーズを深掘りするヒアリング力を活かし、地域のお客様に本当に必要なソリューションを提供することで、貴社の市場シェア拡大に貢献します。",
            '製品・技術特化型パターン': "**[結論]** 貴社のAI技術を駆使した革新的な医療診断システムに感銘を受け、この技術をさらに発展させるエンジニアとして貢献したいと強く志望しております。**[Why Industry]** 私の研究テーマである『高精度画像認識アルゴリズム』は、特に医療分野での貢献を目標としてきました。**[Why Company]** 貴社は、この分野で**国内トップクラスの特許数**を持ち、その研究環境と最先端の技術力は、私のキャリアビジョンを実現するための最適な場だと確信しています。**[How I Contribute]** 研究で培った高度なプログラミングスキルと粘り強さをもって、入社後は**新バージョンの開発チーム**に早期に参画し、システム精度の向上に貢献します。",
            '企業文化と挑戦型パターン': "**[結論]** 貴社の『失敗を恐れず、常に市場に新しい価値を提供する』という挑戦的な企業文化に魅力を感じ、私の『積極的な実行力』を最大限に活かせると確信しています。**[Why Industry]** 私は、変化の激しい現代において、既存の枠にとらわれないサービスこそが人々の生活を豊かにすると考えます。**[Why Company]** 特に貴社の新規事業提案制度は、若手にも積極的にチャンスを与えるものであり、私のアイデアを形にする土壌があると感じました。**[How I Contribute]** 持ち前の行動力で、入社後すぐにこの制度を活用し、貴社の新規顧客獲得のための**革新的なプロモーション企画**を立案・実行することで、事業の多様化に貢献します。"
            // ★★★ 志望動機の回答例を大幅に強化（ここまで） ★★★
        },
        checklist: ["「なぜこの会社か」を明確にできた", "企業研究の結果を示せた", "入社後のビジョンを語れた"],
        prompt_focus: "【志望動機へのフィードバック依頼】\n[質問: 志望動機をお聞かせください]\n\n以下の私の回答に対して、論理の一貫性、熱意の伝わりやすさ、そして回答が競合他社でも通用する内容になっていないか(独自性があるか)を確認してください。",
        audio_sources: {
            kyarijii: "day4_guidance.mp3",
            normal: "day4_normal.mp3"
        }
    },
    5: {
        title: "#5日目# 入社後に活かせるスキルや経験は何ですか?",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "5日目じゃな。だいぶ調子が出てきたんじゃないか？今日のテーマは、『入社後に活かせるスキル』じゃ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "これは、君の『自己PR』を、さらに具体的に『仕事』に結びつける質問じゃな。<br>面接官は、『即戦力』として活躍できるか、その『根拠』が知りたいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "具体的な貢献度をイメージさせるための質問。職種に直結する専門性と、汎用性の高いポータブルスキルを分けて説明する。",
        points: ["応募職種の業務内容を理解した上で、最も関連性の高いスキルを挙げる。", "「スキル」だけでなく、それを活かした「経験」と「成果」をセットで話す。", "専門スキルがない場合は、学習意欲や汎用スキル(コミュニケーション、PCスキルなど)を強調する。"],
        example_simple: "接客のアルバイトで培った顧客とのコミュニケーション能力と、ゼミで学んでいるデータ分析のスキルを活かせると考えています。",
        example_detailed: {
            '専門スキル(ITなど)パターン': "前職のシステム開発において、特にデータベース設計の経験が豊富です。貴社の新プロジェクトにおける△△の業務において、この設計スキルを活かし、初期段階から貢献できると確信しています。",
            '対人スキル(営業・接客)パターン': "お客様の潜在的なニーズを引き出すヒアリング力です。前職の営業職では、このヒアリング力を活かし、お客様一人ひとりに最適な提案を行うことで、平均売上の15%向上を達成しました。",
            '汎用スキル(PC・言語)パターン': "高いレベルのPCスキルと、英語でのコミュニケーション能力です。特にExcelやPowerPointを駆使した資料作成や分析作業は、効率よく行える自信があり、海外支社とのやり取りにも貢献できます。"
        },
        checklist: ["応募職種に必要なスキルを挙げた", "スキルを裏付ける具体的なエピソードがある", "入社後の貢献イメージが具体的である"],
        prompt_focus: "【活かせるスキルへのフィードバック依頼】\n[質問: 入社後に活かせるスキルや経験は何ですか?]\n\n以下の私の回答に対して、応募職種の必須要件とのマッチ度、スキルを裏付けるエピソードの具体性、そして過度に自己評価が高くないかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day5_guidance.mp3",
            normal: "day5_normal.mp3"
        }
    },
    6: {
        title: "#6日目# 成功体験と失敗体験を教えてください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "6日目じゃ。今日は少し変わった角度からじゃぞ。テーマは『成功体験と失敗体験』じゃ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "なぜ、わざわざ『失敗』を聞くんじゃと思うか？<br>...そうじゃ。面接官は、君が失敗から『何を学び、どう立ち直ったか』、その『成長力』や『人間性』を見たいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "成功から得た自信と、失敗から何を学びどう立ち直ったか、バランスよく人間性を伝える。",
        points: ["成功体験は「目標達成へのプロセス」を、失敗体験は「反省と改善点」を強調する。", "失敗は「大したことがない」話ではなく、しっかりと反省できる人間であることを示す。", "失敗の後に、具体的な行動変容があったかを示す。"],
        example_simple: "成功体験は目標売上の達成、失敗体験は準備不足によるプレゼン失敗です。どちらからも学びを得ました。",
        example_detailed: {
            "目標達成と計画性不足パターン": "(成功)長期インターンで、Webサイトの**顧客転換率(CVR)を2倍に改善**したことです。定量・定性データ分析に基づき、サイト構成を抜本的に見直しました。(失敗)一方、大学のゼミでプロジェクトリーダーを務めた際、**計画段階でのリスク見積もりが甘かった**ため、納期直前で大きな問題に直面しました。この失敗から、成功体験で培った**データ分析力**を活かし、以降は**初期段階で徹底したリスク評価**を必ず行うようになりました。",
            "チーム貢献とコミュニケーション不足パターン": "(成功)サークル活動で、長年の課題だった地域イベントへの参加を、**チーム全員の協力を得て**実現させたことです。関係者との複雑な交渉も、共通の目的を共有することで乗り越えました。(失敗)しかし、アルバイト先の新しいマニュアル導入時、**現場スタッフへの意図の説明が不十分**だったため、反発を受け導入に失敗しました。この失敗から、成功体験で学んだ**巻き込み力**を活かし、以降は**対話の場**を設けて、「なぜそれが必要か」という**目的を丁寧に説明**するよう徹底しています。",
            "ゼロイチ創造と思い込みパターン": "(成功)大学の研究室で、それまで誰も成功させていなかった**新しい実験手法をゼロから確立**したことです。粘り強い分析と外部の専門家への意見聴取が成功に繋がりました。(失敗)一方、サークルでイベント企画をした際、**過去の成功体験に固執**し、市場調査を怠って独断で進め、参加者が大幅に下回りました。この経験から、成功体験で学んだ**粘り強さ**は維持しつつ、**客観的なデータ**と**他者の意見**を謙虚に取り入れる重要性を学びました。",
            "数値結果と初期対応の遅れパターン": "(成功)飲食店アルバイトで、オペレーションを改善し、**提供時間を平均2分短縮**させたことです。全プロセスの無駄を排除し、数値目標を達成しました。(失敗)しかし、研究活動において、実験データの**初期段階での小さな異常を見過ごしてしまった**ことで、問題が深刻化し、研究を数週間巻き戻す失敗をしました。成功体験で培った**細部へのこだわり**を活かし、以降は問題の大小にかかわらず、**兆候を見つけた時点で直ちに原因を究明する**という初期対応の重要性を痛感しています。",
            "困難克服と優先順位付けの失敗パターン": "(成功)海外ボランティア活動中に、言葉の壁や文化の違いからコミュニケーションが取れないという困難を、**非言語コミュニケーションと現地の言語学習で克服**し、目標を達成できました。この経験で**適応力**が強みとなりました。(失敗)一方、長期インターンで複数のプロジェクトを担当した際、**タスクの優先順位付けを誤り、最も重要な納期の遅延を招いた**ことです。この失敗から、成功体験で学んだ**適応力**を活かし、**緊急度よりも重要度**を重視したタスク管理のフレームワークを導入し、改善を図っています。"
        },
        checklist: ["成功と失敗の両方を具体的に語れた", "失敗を他人のせいにしなかった", "失敗から得た教訓を仕事に結びつけた"],
        prompt_focus: "【成功・失敗体験へのフィードバック依頼】\n[質問: 成功体験と失敗体験を教えてください]\n\n以下の私の回答に対して、成功体験の再現性、失敗体験からの学びの深さ、そして両者のバランスが取れているかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day6_guidance.mp3",
            normal: "day6_normal.mp3"
        }
    },
    7: {
        title: "#7日目# あなたが他者を巻き込んで何かを成し遂げた経験を話してください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "よし、7日目！ ちょうど折り返し地点じゃな！今日のテーマは、『他者巻き込み』じゃ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "仕事というものは、決して一人ではできん。必ず、チームで進めるもんじゃ。<br>だから面接官は、君の『リーダーシップ』や『協調性』、つまり『チームの中でどう動けるか』を知りたいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "チームワーク、影響力、リーダーシップを測る質問。協調性と目標達成意欲をアピールする。",
        points: ["目標達成のために、チームメンバーにどう働きかけたかを具体的に説明する。", "自分の役割だけでなく、他者の貢献を認識していることを示す。", "意見が対立した際に、どのように合意形成を図ったかを説明する。"],
        example_simple: "サークルのイベントで、メンバーの協力を得て企画を成功させました。特に、困難な場面でメンバーの士気を高める役割を担いました。",
        example_detailed: {
            "合意形成型パターン": "(エピソード)アルバイト先で新メニュー開発に携わった際、意見の異なる他部署のメンバーを巻き込む必要がありました。私は定期的な合同会議を設定し,共通の顧客利益という目標を再確認することで,建設的な議論を促し,最終的に新メニューを大ヒットさせました。",
            "士気向上・貢献型パターン": "(エピソード)大学のゼミでチーム研究を行った際、テーマの難易度が高く、メンバーのモチベーションが低下していました。私はまず、**メンバー一人ひとりの得意分野と興味**をヒアリング。その強みを最大限に活かせる役割に再配置し、小さな成功を共有する場を設けて**達成感を積み重ね**ました。その結果、チームの士気が回復し、研究を**学会発表**まで漕ぎ着けることができました。",
            "利害調整・橋渡し型パターン": "(エピソード)地域ボランティア活動の企画・運営において、若手とベテランの間で活動方針に関する**意見の対立**が生じました。私は一方的な判断をせず、双方の意見を丁寧に聞き、ベテランの**「経験に基づく慎重さ」**と若手の**「新しい手法への意欲」**を対立ではなく、**リスクヘッジと革新**という形で統合するハイブリッドな計画を提案。これにより、全員が納得する形でプロジェクトを前進させることができました。",
            "新規ルール浸透・改革型パターン": "(エピソード)カフェでのアルバイトで、新人研修後の定着率が低いという課題に直面しました。私は、「マニュアルの複雑さ」が原因だと特定し、店長に働きかけ、**現場主導の新人サポート制度**の導入を提案。経験豊富なアルバイト(先輩)たちを「メンター」として巻き込み,OJT(オンザジョブトレーニング)を仕組み化しました。結果、新人の不安が解消され、研修後の**定着率を半年で20%改善**させることができました。",
            "目標共有・全体最適型パターン": "(エピソード)テニスサークルの部長として、練習参加率の低下という課題に直面しました。私はまず、サークル全体で**「〇〇大会優勝」という具体的な目標**を掲げ、メンバー全員との面談を通じて**目標に対するコミットメント**を引き出しました。そして、目標達成のために必要な個人レベルの成長プランを共有することで、**『自分の練習がチームに貢献する』**という意識を浸透させ、サークル全体を巻き込み、練習参加率と実力向上を両立させました。"
        },
        checklist: ["巻き込みの目標を明確にした", "具体的な働きかけを説明できた", "チームでの成果を自分の貢献と分けて説明できた"],
        prompt_focus: "【他者巻き込み経験へのフィードバック依頼】\n[質問: 他者を巻き込んで何かを成し遂げた経験を話してください]\n\n以下の私の回答に対して、リーダーシップの形(指示型か支援型か)、そしてメンバーを納得させた説得力についてフィードバックをください。",
        audio_sources: {
            kyarijii: "day7_guidance.mp3",
            normal: "day7_normal.mp3"
        }
    },
    8: {
        title: "#8日目# ストレスはどのように解消しますか?",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "8日目じゃ。後半戦も頑張っていこう。今日のテーマは、『ストレス解消法』じゃ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "『え、そんなプライベートなことを？』と思うかもしれんが、これも地味ながら大事な質問じゃぞ。<br>面接官は、君が『自己管理』をしっかりできて、長く健康に働いてくれるかを確認したいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "ストレス耐性、自己管理能力、そしてメンタルヘルスの重要性を理解しているかを測る。ネガティブな印象を与えないよう注意。",
        points: ["ストレスの「原因」ではなく、「解消法」と「再発防止策」に焦点を当てる。", "解消法は健康的で建設的なものを挙げる。", "ストレスを溜め込む前に、いかに自己認識し対処できるかを示す。"],
        example_simple: "運動や趣味に時間を費やすことでストレスを解消します。特に、仕事に集中できるよう、週末には必ずリフレッシュする時間を設けています。",
        example_detailed: {
            'リフレッシュ型パターン': "(解消法)ジョギングや読書でリフレッシュします。特にジョギングは、頭の中を整理し、仕事の課題を客観的に見つめ直す時間になっています。",
            '自己管理型パターン': "(自己管理)ストレスを感じ始めたら、すぐに信頼できる同僚や上司に相談し、一人で抱え込まないよう心がけています。"
        },
        checklist: ["解消法が健康的で建設的である", "ストレスを自己認識できていることを示せた", "仕事に支障をきたさないことを示唆できた"],
        prompt_focus: "【ストレス解消法へのフィードバック依頼】\n[質問: ストレスはどのように解消しますか?]\n\n以下の私の回答に対して、解消法が仕事の継続性に影響を与えないか、また、自己管理能力が伝わる内容になっているかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day8_guidance.mp3",
            normal: "day8_normal.mp3"
        }
    },
    9: {
        title: "#9日目# あなたの強みと弱みを改めて教えてください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "9日目じゃな。今日のテーマは、『強みと弱み』じゃ。自分と向き合うぞ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "面接官が『弱み』を聞くのは、君をイジメたいわけじゃないぞ（笑）<br>そうじゃなく、君が自分を『客観視』できているか、そしてその弱みを『改善しようと努力』しているかを知りたいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "自己分析の深さと客観性を測る。弱みは仕事に致命的でないものを選び、改善努力をセットで話す。",
        points: ["強みと弱みのバランスを取る(表裏一体である必要はない)。", "弱みは必ず「改善への取り組み」とセットで話す。", "応募職種にとって致命的となる弱み(例:エンジニアなのに論理的思考が苦手)は避ける。"],
        example_simple: "強みは行動力、弱みは慎重さに欠ける点です。弱みは意識してチェックリストを使うことで改善しています。",
        example_detailed: {
            "論理的思考力とスピード不足パターン": "私の強みは、複雑な状況を整理し、構造的に理解できる**論理的思考力**です。一方で弱みは、その思考を突き詰めるあまり、物事の**結論を出すまでに時間をかけすぎてしまう点**です。現在は、タスクに着手する際に**「まず60%の完成度でアウトプットする」という期限**を設け、上司やチームに早期に共有することで、スピードを意識的に改善しています。",
            "共感力と断れないパターン": "私の強みは、チームメンバーの気持ちを汲み取り、円滑な人間関係を築く**共感力**と**傾聴力**です。しかし、これが裏目に出て、**他者からの依頼を断りきれず、自分の業務を圧迫してしまう点**が弱みです。改善策として、依頼を受けた際に**自分のタスク管理表を即座に確認**する習慣をつけ、「依頼の目的」と「自分のリソース」を比較検討し、優先度の低い依頼は代替案を提示して断るよう徹底しています。",
            "徹底力と完璧主義パターン": "私の強みは、一度決めた目標に対して、手を抜かずに最後までやり切る**徹底力**です。弱みは、**完璧主義**に陥りがちで、特に初めての業務で、**必要以上に時間をかけてしまうこと**です。これを克服するため、プロジェクト開始時に**「このタスクの合格ラインは何か」**を上司や先輩に明確に確認し、目標ラインを超えたら、次のタスクへ移行するよう意識的にセルフチェックをかけています。",
            "行動力と慎重さ不足パターン": "私の強みは、新しい課題に対して臆せず飛び込む**行動力**と**適応力**です。その反面、目の前の課題解決に集中するあまり、**全体像を俯瞰した慎重な計画が不足しがちな点**が弱みです。現在は、大きなアクションを起こす前に、必ず**「5W2Hで計画を箇条書きにする」という手順**を強制的に踏むことで、行動の前に思考のプロセスを組み込むよう改善しています。",
            "ポジティブさと客観性不足パターン": "私の強みは、困難な状況でも前向きな姿勢を保ち、チームに活気を与える**ポジティブさ**です。弱みは、常にポジティブに捉えようとしすぎる結果、**客観的なリスクやネガティブな兆候を見落としてしまうことがある点**です。この弱みを補うため、重要な意思決定の前には、必ず**批判的な視点を持つ同僚や先輩**に意見を求め、**第三者の客観的なフィードバック**を取り入れる仕組みを構築しています。"
        },
        checklist: ["強みと弱みに一貫性があるか確認した", "弱みの改善策を具体的に述べた", "弱みが仕事に致命的ではないことを示した"],
        prompt_focus: "【強みと弱みへのフィードバック依頼】\n[質問: あなたの強みと弱みを改めて教えてください]\n\n以下の私の回答に対して、弱みが仕事に致命的でないか、そして弱みの改善策が現実的で具体的な行動を伴っているかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day9_guidance.mp3",
            normal: "day9_normal.mp3"
        }
    },
    10: {
        title: "#10日目# 入社後のキャリアプランを教えてください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "10日目、大台に乗ったな！今日のテーマは、『キャリアプラン』じゃ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "これは、君の『未来』と会社の『未来』が、ちゃんと合っているか、すり合わせる質問じゃ。<br>面接官は、君が『長期的な視点』で会社に貢献してくれるか、その『本気度』と『計画性』を見たいんじゃな。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "入社意欲の高さと、企業の事業への理解度を測る。企業のビジョンと自分の成長が一致していることを示す。",
        points: ["短期(1〜3年)、中期(5年)、長期(10年)といった具体的な期間で区切って話す。", "企業の具体的な部署名やプロジェクト名を挙げ、具体的な役割をイメージさせる。", "単なる昇進ではなく、「どう成長して会社にどう貢献するか」に焦点を当てる。"],
        example_simple: "まずは現場で経験を積み、5年後にはチームをリードできる人材になりたいです。10年後には会社の中心となって事業を推進したいです。",
        example_detailed: {
            '専門性の追求パターン': "入社後3年間は、貴社の〇〇分野で専門知識を徹底的に学び、まずは一人前のエキスパートとして貢献します。5年後には、その専門性を活かして新しい技術の導入を牽引し、最終的には技術開発部門のリーダーとして、貴社の技術力を世界レベルに引き上げたいです。",
            'マネジメント志向パターン': "最初の数年で、現場の業務知識を深く理解した上で、早期にチームリーダーとしてマネジメントに挑戦したいです。5年後には、複数のチームを束ねるマネージャーとして、組織全体の生産性向上に貢献できる人材になりたいと考えています。",
            '新規事業への挑戦パターン': "まずは既存事業で成果を出すことに集中しますが、3年後を目処に、貴社の新しい市場開拓に携わりたいです。特に△△という領域に注目しており、自分のアイデアと実行力で、貴社の次の柱となる新規事業を立ち上げることが目標です。"
        },
        checklist: ["具体的な期間で区切って話した", "企業のビジョンと合致しているか確認した", "「貢献」を軸に話した"],
        prompt_focus: "【キャリアプランへのフィードバック依頼】\n[質問: 入社後のキャリアプランを教えてください]\n\n以下の私の回答に対して、プランが現実的か、また、単なる「出世欲」ではなく「貢献意欲」が伝わるかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day10_guidance.mp3",
            normal: "day10_normal.mp3"
        }
    },
    11: {
        title: "#11日目# 今までで一番達成感を感じたことは何ですか?",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "11日目じゃ。今日のテーマは、『一番の達成感』じゃ。君の心が震えた瞬間を思い出すんじゃ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "『成功体験』と似ているが、こっちはもう少し『感情』にフォーカスした質問じゃな。<br>君の『やる気のスイッチ』がどこにあるか、探ろうとしておるんじゃ。君が『どんな時』に『何を』やりがいと感じるかを知りたいんじゃな。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "モチベーションの源泉、目標達成までの道のり、そして成果を出すための行動特性を測る。成功体験(Day 6)と異なり、感情的な側面も深く問われる。",
        points: ["達成感の裏側にある「困難」や「努力」を具体的に述べる。", "個人的な感情だけでなく、その経験から得た教訓やスキルを仕事にどう活かせるか結びつける。", "仕事や学業に直結しないエピソードでも、そのプロセスが論理的であれば問題ない。"],
        example_simple: "アルバイトで新企画を成功させたときです。目標を達成するためにチーム一丸となって努力し、大きな達成感を得ました。",
        example_detailed: {
            "目標達成型パターン": "大学受験での第一志望合格です。模試の結果が振るわなかった際も、単に勉強時間を増やすだけでなく、苦手分野の徹底分析と効率的な学習計画に切り替えました。結果、合格を勝ち取り、目標達成のために冷静に戦略を練る重要性を学びました。",
            "チーム貢献型パターン": "サークル活動で、長年の課題だった地域イベントへの参加を実現させたことです。関係者との交渉、メンバーの意見調整など多くの困難がありましたが、チーム全員が役割を全うし、イベントを成功させた時の達成感は忘れられません。",
            "困難克服型パターン": "海外ボランティア活動中に、言葉の壁や文化の違いからコミュニケーションが取れず、孤立した経験です。私は諦めず、非言語コミュニケーションや現地の言語を熱心に学び、最終的に現地の方々との信頼関係を構築し、目標を達成できました。",
            "数値結果改善型パターン": "長期インターンで任されたWebサイトの**顧客転換率(CVR)を2倍に改善**したことです。既存の施策では限界があると感じ、自らユーザーインタビューを企画・実施。定量データと定性データの両方に基づき、サイト構成を一から見直しました。自分の分析と提案が、明確な数値となって現れた瞬間に、大きな達成感を覚えました。",
            "ゼロイチ創造型パターン": "大学の研究室で、それまで誰も成功させていなかった**新しい実験手法をゼロから確立**したことです。試行錯誤の連続で、何度も失敗し研究の継続が危ぶまれましたが、過去の失敗データを徹底的に分析し、指導教員だけでなく外部専門家にも意見を求めて打開策を見つけました。その手法で最初の成功データが出たとき、困難を乗り越えた最高の達成感がありました。"
        },
        checklist: ["達成感の根拠となる努力を具体的に語った", "プロセスから得られた教訓を明確にした", "話に熱意が込められていたか確認した"],
        prompt_focus: "【達成感の経験へのフィードバック依頼】\n[質問: 今までで一番達成感を感じたことは何ですか?]\n\n以下の私の回答に対して、感情的な達成感だけでなく、その経験が私の仕事への取り組み方や問題解決能力を証明しているかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day11_guidance.mp3",
            normal: "day11_normal.mp3"
        }
    },
    12: {
        title: "#12日目# 最近気になるニュースや社会問題はありますか?",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "12日目じゃな。今日のテーマは、『最近気になるニュース』じゃ。君の『アンテナ』の感度を試すぞ。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "面接官は、君が普段から『社会』や『業界』に関心を持っているか、その『情報感度』と、ニュースに対する『自分の意見』を持っているかを知りたいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "社会への関心度、論理的思考力、そしてそのニュースと企業・業界との関連性を測る。",
        points: ["応募企業や業界に関連性の高いニュースを選ぶと良い。", "単にニュースを説明するだけでなく、「それに対する自分の意見」と「会社としてどう対応すべきか」を述べる。", "政治や宗教など、センシティブなテーマは避けるのが無難。"],
        example_simple: "〇〇業界におけるAI技術の進化に注目しています。貴社の事業にも大きな影響があると見ています。",
        example_detailed: {
            '社会情勢・提言型パターン': "(ニュース)最近の円安・物価高騰が気になっています。(意見)これは消費者の購買力を低下させるだけでなく、企業活動における原材料費の高騰を招いています。(会社との関連)貴社のようなグローバル企業にとっては、生産拠点の分散や、コスト削減のための業務効率化が喫緊の課題になると考えます。私は〇〇のスキルでその効率化に貢献したいです。"
        },
        checklist: ["ニュースの内容を正しく理解しているか確認した", "自分の意見を明確に述べた", "応募企業との関連性を示せた"],
        prompt_focus: "【ニュースへの意見へのフィードバック依頼】\n[質問: 最近気になるニュースや社会問題はありますか?]\n\n以下の私の回答に対して、ニュースの分析の深さ、自分の意見の論理性、そして回答が単なる情報提供で終わっていないか(意見や提言があるか)についてフィードバックをください。",
        audio_sources: {
            kyarijii: "day12_guidance.mp3",
            normal: "day12_normal.mp3"
        }
    },
    13: {
        "title": "#13日目# 逆質問はありますか?",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "13日目、いよいよ終盤じゃぞ！今日のテーマは、『逆質問』じゃ！",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "ここで『特にありません』と答えるのは、一番やってはいかんぞ！<br>これは、君の『入社意欲の高さ』と『企業理解の深さ』を示す、『最後の自己PRチャンス』なんじゃ！",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        "description": "面接の最後を締めくくる最も重要な質問。**「事前に調べればわかること」を避けた質問**を通じて、入社意欲と**企業への深い関心**、そして**入社後の貢献意欲**をアピールする絶好の機会。",
        "points": [
            "**企業理念やIR情報など、公開されている情報を踏まえた上での「深掘り質問」**を準備する。",
            "質問を通じて、**自分の強みがどう活かせるか**という視点を間接的に示す。",
            "意欲を示すため、**2〜3つ**質問を準備しておくのが望ましい。",
            "**面接官の役職や部門**に合わせて、質問内容を使い分ける(例:現場マネージャーには業務詳細、役員には経営戦略)。"
        ],
        "example_simple": "貴社のIR資料を拝見し、〇〇分野への投資を強化されていると理解していますが、この取り組みについて面接官様が現場で感じていらっしゃる具体的な課題感や期待値を教えていただけますか?",
        "example_detailed": {
            "事業戦略の深掘り質問パターン": "貴社の『中期経営計画』における〇〇事業の目標を達成するために、現場では現在、**最も大きなボトルネック**となっているのはどのような点でしょうか?また、そこに貢献するために私のような立場の社員に期待される具体的な役割についてもお伺いしたいです。",
            "競合優位性に関する質問パターン": "貴社の主力製品である〇〇が、競合他社製品と比較して市場で優位性を保ち続けている**「決定的な理由」**について、現場の最前線で働く面接官様の考えをお聞かせいただけますか?(※製品の技術的な優位性は事前に把握済みです)",
            "カルチャーと行動に関する質問パターン": "貴社の企業理念に「**挑戦を尊ぶ文化**」とありますが、面接官様が実際に部下の方が挑戦する際に、**「どのような失敗であれば許容し、どのような行動を最も評価するのか」**の具体的な判断基準についてお伺いしたいです。",
            "入社後の成長機会に関する質問パターン": "私は入社後、〇〇という目標を達成したいと考えております。この目標を持つ上で、貴社では新入社員が**自主的に学ぶことを支援する具体的な制度(研修や予算など)**はありますでしょうか?"
        },
        "checklist": [
            "公開情報だけではわからない、**深掘りされた質問**を準備した",
            "質問の前に**「〇〇を拝見して/理解して」**という前置きを入れた",
            "質問が入社後の貢献や具体的な業務に関するものであるか確認した",
            "2〜3つの質問を準備した"
        ],
        "prompt_focus": "【逆質問のフィードバック依頼】\n[質問: 逆質問はありますか?]\n\n以下の私が準備した逆質問のリストに対して、質問のレベル感、入社意欲の伝わりやすさ、そして面接官が答えやすい質問になっているかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day13_guidance.mp3",
            normal: "day13_normal.mp3"
        }
    },
    14: {
        title: "#14日目# あなたの座右の銘を教えてください",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "14日目じゃ。今日のテーマは、『座右の銘』じゃ。君の『軸』を見せるときじゃな。",
        chara_think_title: "まずは、この質問の意図をかんがえてみよう",
        chara_think_text: "ちょっと古風な質問かもしれんが、あなどれんぞ。<br>面接官は、君が『何を大切にして行動しているか』という『軸』や『信念』、つまり『人となり』を知りたいんじゃ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "あなたの価値観や行動原則を測る質問。座右の銘だけでなく、それがあなたの行動にどう影響しているかを説明する。",
        points: ["座右の銘はシンプルで分かりやすいものを選ぶ。", "その言葉を選んだ理由と、具体的なエピソードを結びつける。", "企業理念や仕事への姿勢と矛盾しないかを確認する。"],
        example_simple: "「継続は力なり」です。目標に向かって毎日コツコツと努力を続けることを大切にしています。",
        example_detailed: {
            "行動原則型パターン": "(座右の銘)「為せば成る、為さねば成らぬ何事も」です。(理由)私はこの言葉を、単に精神論としてではなく、目標達成のためにはまず一歩踏み出す**行動力が不可欠**であるという行動原則として捉えています。困難な状況でも諦めずに目標を達成しようとする**挑戦**することを常に意識しています。",
            "継続力型パターン": "(座右の銘)「継続は力なり」です。(理由)私は、大きな目標を前にした時こそ、この言葉を思い出します。一見地味に見える**日々の小さな努力**や、**PDCAを回し続ける粘り強さ**が、最終的に大きな成果を生むと信じており、研究活動においてもこの姿勢を貫きました。",
            "問題解決型パターン": "(座Vの銘)「本質を見極める」です。(理由)この言葉は、複雑な問題に直面したときに、**表面的な現象に惑わされず、根本原因(ボトルネック)を追求する**姿勢を私に与えてくれます。アルバイト先の売上改善においても、常にこの原則で取り組みました。",
            "チームワーク型パターン": "(座右の銘)「一期一会」です。(理由)私は、目の前の人との出会いを大切にし、**相手の意見や個性を深く理解しようと努める**ことを重視しています。特にチーム活動においては、多様な価値観を尊重し、**相互理解**を深めることで、最高のチームワークを目指します。",
            "当事者意識型パターン": "(座右の銘)「自彊不息(じきょうやまず)」です。(理由)自分から努め励み、**休まず努力し続ける**という意味です。これは、**「誰かがやるだろう」ではなく「自分が当事者として やる」**という強い責任感と、常に自己成長を怠らない向上心を持って仕事に取り組む私の姿勢を表しています。",
            "変化対応型パターン": "(座右の銘)「塞翁が馬(さいおうがうま)」です。(理由)物事の良し悪しは、その時々で決まるものではないというこの言葉から、私は**現状に一喜一憂せず、長期的な視点を持つ**ことの重要性を学びました。予期せぬ困難に直面した際でも、これを**成長の機会**と捉え、柔軟に対応するよう心がけています。",
            "プロ意識型パターン": "(座右の銘)「念ずれば花ひらく」です。(理由)この「念」は、単なる願望ではなく、**目標達成に向けた強い意志と、それを裏付ける徹底した準備・努力**を意味すると考えています。プロとして高い成果を出すためには、**準備の段階から強い覚悟**を持つことが不可欠だと信じています。",
            "成長意欲型パターン": "(座Vの銘)「知行合一」です。(理由)知識(知)は、実行(行)を伴ってこそ真の価値を持つという意味です。私は**インプットとアウトプットを常に一体**として考え、学んだことはすぐに**試行し、検証する**というサイクルを回すことで、速いスピードでの自己成長を目指しています。",
            "積極性型パターン": "(座右の銘)「果断(かだん)」です。(理由)私はこの言葉を**「決断力と実行力」**を持つ姿勢として捉えています。現代のビジネスでは、**情報を収集しすぎることなく、最適なタイミングで決断**し、即座に実行に移すスピードが重要であると認識し、意識的に実践しています。",
            "感謝・謙虚型パターン": "(座右の銘)「報恩謝徳(ほうおんしゃとく)」です。(理由)受けた恩や恵みに報いることを意味します。私は、自分の成功は決して自分一人の力ではなく、**多くの人の支えや機会によるもの**だと常に感謝の念を持っています。この謙虚な姿勢が、周囲への敬意と、より良い協力関係を築く基盤となっています。"
        },
        checklist: ["座右の銘を選んだ理由を明確にできた", "具体的な行動との結びつきを説明できた", "話に深みが加わったか確認した"],
        prompt_focus: "【座右の銘へのフィードバック依頼】\n[質問: あなたの座右の銘を教えてください]\n\n以下の私の回答に対して、座右の銘が私の行動原理として納得できるか、そして仕事への姿勢としてポジティブに伝わるかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day14_guidance.mp3",
            normal: "day14_normal.mp3"
        }
    },
    15: {
        title: "#15日目# 面接全体を振り返ろう",
        chara_lead_title: "キャリ爺じゃ！",
        chara_lead_text: "ついに最終日、15日目じゃ！ここまで本当によく頑張ったな！わしは嬉しいぞ。",
        chara_think_title: "最後の仕上げじゃ！",
        chara_think_text: "これまで準備してきた『自己PR』『ガクチカ』『志望動機』…<br>それら全てに『一貫性』があるか？『君』という人物の『軸』がブレていないか？最後の総チェックをするぞ。",
        chara_example_intro: "キャリ爺が「回答例」を教えるぞ！",
        ai_chara_title: "よーし、君の回答をまずは、書いてみよう。<br>大丈夫です、「AIお助けマン」がサポートしますよ！",
        description: "総まとめ。プログラム全体を通じて、回答準備がどこまで進んだか、最終確認を行う。",
        points: ["自分の回答を録音・録画し、客観的に評価する。", "特に準備が不十分だと感じた質問を特定し、重点的に改善する。", "面接官役の友人や家族に模擬面接をしてもらい、フィードバックを得る。"],
        example_simple: "このプログラムを通じて、すべての質問に対する論理的な回答を作成できました。あとは本番で自然に話せるよう練習を続けます。",
        example_detailed: {
            '最終確認型パターン': "(目標)全質問に対して、自信を持って3分以内で説明できるようにする。(反省点)特に、「弱み」に関する回答が弱かったため、改善点を具体的に述べられるよう、回答をブラッシュアップします。"
        },
        checklist: ["全質問の回答を3分以内にまとめられた", "自己PRと志望動機に一貫性があるか再確認した", "想定外の質問への対応策を考えた"],
        prompt_focus: "【最終振り返りフィードバック依頼】\n[質問: このプログラムで最も準備が難しいと感じた質問はどれですか?]\n\n私の学習結果全体を想定し、この回答を補強するために、どのような質問が面接官から深掘りされる可能性が高いかについてフィードバックをください。",
        audio_sources: {
            kyarijii: "day15_guidance.mp3",
            normal: "day15_normal.mp3"
        }
    },
};
// ★★★ ここまで ★★★

// 重要度別カテゴリの区分け
const categories = {
    core: [1, 2, 3, 4, 7, 10, 13],
    key: [5, 9, 6],
    good: [8, 11, 12, 14, 15]
};

let currentDay = 0;
let currentNavTab = 'daily';
let currentCategory = 'core';

// DOMの参照 (主要なもの)
const listDaily = document.getElementById('questions-list-daily');
const listCategoryContainer = document.getElementById('list-category-container');
const listDailyContainer = document.getElementById('list-daily-container');
const categoryFilterNav = document.getElementById('category-filter-nav');
const lists = {
    core: document.getElementById('questions-list-core'),
    key: document.getElementById('questions-list-key'),
    good: document.getElementById('questions-list-good')
};
const tabDaily = document.getElementById('tab-daily');
const tabCategory = document.getElementById('tab-category');
const contentContainer = document.getElementById('content-container');
const progressBarFill = document.getElementById('progress-bar-fill');
const progressText = document.getElementById('progress-text');
let mainAudio = document.getElementById('main-audio');

// --- ( formatTime 関数 ) ---
const formatTime = (seconds) => {
    if (isNaN(seconds) || seconds < 0) return '0:00';
    const min = Math.floor(seconds / 60);
    const sec = Math.floor(seconds % 60);
    return `${min}:${sec < 10 ? '0' : ''}${sec}`;
};

// --- ( renderDayContent 関数 ) ---
const renderDayContent = (day) => {
    if (!mainAudio.paused) mainAudio.pause();
    mainAudio.src = '';
    
    currentDay = day;
    const data = questionsData[day];
    
    document.querySelectorAll('aside ul li').forEach(li => {
        li.classList.remove('active-day');
    });
    const activeItem = document.querySelector(`aside ul li[data-day="${day}"]`);
    if (activeItem) {
        activeItem.classList.add('active-day');
    }

    if (day === 0) {
        contentContainer.innerHTML = `
            <div class="card p-6 text-center">
                <div class="chara-container">
                    <div class="chara-icon chara-kyarijii">
                        <i class="fas fa-smile-beam"></i>
                    </div>
                    <div class="balloon">
                        <h4 class="balloon-title">ようこそ！</h4>
                        <p class="text-gray-700">まずは、左のメニューから修行したい日を選ぶか、重要度別版でチャレンジするんじゃ！</p>
                    </div>
                </div>
                <h2 class="text-2xl font-bold text-gray-700">${data.title}</h2>
                <p class="mt-4 text-gray-600">このプログラムは、主要な面接質問に対する体系的な回答準備を15日間で完了させることを目的としています。</p>
                <p class="mt-2 text-gray-600">左側のメニューから、学習したい日(質問)を選択してください。</p>
                <p class="mt-4 text-xs text-gray-400">※「はじめに」には進捗管理やフィードバック機能はありません。</p>
            </div>
        `;
        return;
    }

    let charaLeadHtml = '';
    let charaThinkHtml = '';
    let charaExampleTitleHtml = '';
    let aiCharaHtml = '';

    if (data && data.chara_lead_title) {
        charaLeadHtml = `
            <div class="chara-container">
                <div class="chara-icon chara-kyarijii">
                    <i class="fas fa-smile-beam"></i>
                </div>
                <div class="balloon">
                    <h4 class="balloon-title">${data.chara_lead_title}</h4>
                    <p class="text-gray-700">${data.chara_lead_text}</p>
                </div>
            </div>
        `;
        charaThinkHtml = `
            <div class="chara-container chara-think">
                <div class="chara-icon chara-kyarijii">
                    <i class="fas fa-smile-beam"></i>
                </div>
                <div class="balloon balloon-think">
                    <h4 class="balloon-title balloon-title-think">
                        ${data.chara_think_title}
                    </h4>
                    <p class="mt-1 text-gray-700">${data.chara_think_text}</p>
                </div>
            </div>
        `;
        charaExampleTitleHtml = `
            <div class="chara-container chara-example">
                <div class="chara-icon chara-kyarijii">
                    <i class="fas fa-smile-beam"></i>
                </div>
                <div class="balloon balloon-example">
                    <h4 class="balloon-title balloon-title-example">
                        ${data.chara_example_intro}
                    </h4>
                </div>
            </div>
        `;
        aiCharaHtml = `
            <div class="chara-container chara-ai-container">
                <div class="chara-icon chara-ai">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="balloon balloon-ai">
                    <h4 class="balloon-title balloon-title-ai">
                        ${data.ai_chara_title}
                    </h4>
                </div>
            </div>
        `;
    }

    let charaReviewHtml = '';
    if (day > 0) {
        charaReviewHtml = `
            <div class="chara-container">
                <div class="chara-icon chara-kyarijii">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="balloon">
                    <h4 class="balloon-title">今日の修行の進捗じゃ！</h4>
                    <p class="text-gray-700">やり残しがないか、しっかり確認するんじゃぞ。</p>
                </div>
            </div>
        `;
    }
    
    const isDetailedExampleExist = data.example_detailed && Object.keys(data.example_detailed).length > 0;
    
    let detailedExampleHTML = '';
    let initialDetailedExampleText = data.example_simple;

    if (isDetailedExampleExist) {
        const keys = Object.keys(data.example_detailed);
        const options = keys.map(key => 
            `<option value="${key}">${key}</option>`
        ).join('');
        
        initialDetailedExampleText = data.example_detailed[keys[0]];
        
        detailedExampleHTML = `
            <div class="mt-6">
                <h4 class="text-lg font-medium text-gray-700 mb-2">詳細な回答例(パターン別)</h4>
                <select id="detailed-example-select" class="w-full p-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                    ${options}
                </select>
                <p id="detailed-example-text" class="mt-3 p-3 bg-white rounded-lg border text-gray-700 whitespace-pre-wrap">${initialDetailedExampleText.replace(/\n/g, '<br>')}</p>
            </div>
        `;
    }

    contentContainer.innerHTML = `
        <div class="card">
            
            ${charaLeadHtml}

            <h2 class="text-2xl font-bold text-indigo-600">${data.title}</h2>
            <p class="text-gray-600 mt-2">${data.description}</p>

            <div class="audio-player mt-4 p-4 border rounded-lg bg-gray-50">
                <h3 class="text-lg font-semibold mb-2 flex items-center"><i class="fas fa-volume-up mr-2 text-indigo-500"></i> 音声ガイド</h3>
                <div class="flex items-center gap-4">
                    <button id="main-play-pause" class="text-indigo-600 p-2 text-xl hover:text-indigo-800 transition"><i class="fas fa-play"></i></button>
                    <span id="main-current-time" class="text-sm w-10">0:00</span>
                    <div id="main-progress-bar-container" class="flex-grow h-2 bg-gray-300 rounded-full cursor-pointer relative">
                        <div id="main-progress-bar-fill" class="h-2 bg-indigo-500 rounded-full" style="width: 0%;"></div>
                    </div>
                    <span id="main-duration" class="text-sm w-10">0:00</span>
                    
                    <div id="main-speed-controls" class="flex gap-1 text-sm bg-white p-1 rounded-full border">
                        <button data-speed="0.8" class="main-speed-btn py-0.5 px-2 rounded-full text-gray-600 hover:bg-indigo-50 transition">0.8x</button>
                        <button data-speed="1.0" class="main-speed-btn py-0.5 px-2 rounded-full bg-indigo-100 text-indigo-600 font-bold shadow-sm transition">1.0x</button>
                        <button data-speed="1.2" class="main-speed-btn py-0.5 px-2 rounded-full text-gray-600 hover:bg-indigo-50 transition">1.2x</button>
                        <button data-speed="1.5" class="main-speed-btn py-0.5 px-2 rounded-full text-gray-600 hover:bg-indigo-50 transition">1.5x</button>
                    </div>
                </div>
            </div>

            ${charaThinkHtml}

            <div class="mt-6">
                <h3 class="text-xl font-semibold mb-3 text-indigo-700">✅ 回答のポイント</h3>
                <ul class="list-disc list-inside space-y-2 ml-4 text-gray-700">
                    ${data.points.map(p => `<li>${p}</li>`).join('')}
                </ul>
            </div>

            ${charaExampleTitleHtml}
            <div class="mt-2 p-5 bg-yellow-50 rounded-xl border border-yellow-200">
                <div class="mt-4">
                    <h4 class="text-lg font-medium text-gray-700">簡潔な回答例</h4>
                    <p class="mt-2 p-3 bg-white rounded-lg border text-gray-700 whitespace-pre-wrap">${data.example_simple.replace(/\n/g, '<br>')}</p>
                </div>

                ${detailedExampleHTML}
            </div>

            ${aiCharaHtml}
            <div class="mt-2 p-5 bg-indigo-50 rounded-xl border border-indigo-200">
                <textarea id="user-answer" rows="6" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="あなたの回答を入力してください..."></textarea>
                
                <button id="generate-prompt" class="mt-3 w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 shadow-md">
                    僕が作ったプロンプト文言をコピーして、君が使っているAIに添削をしてもらおう
                </button>
                
                <div id="prompt-output" class="mt-4 hidden">
                    <textarea id="generated-prompt-text" rows="8" class="w-full p-3 border border-dashed border-indigo-400 rounded-lg bg-indigo-100 text-sm" readonly></textarea>
                    <button id="copy-prompt" class="mt-2 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150">
                        <i class="fas fa-copy mr-2"></i> 生成したプロンプトをコピー
                    </button>
                </div>
            </div>

            ${charaReviewHtml}
            <div class="mt-2 p-5 bg-blue-50 rounded-xl border border-blue-200">
                <h3 class="text-xl font-semibold mb-3 text-blue-700">📋 今日の振り返りチェックリスト</h3>
                <ul id="checklist" class="space-y-3">
                    ${data.checklist.map((item, index) => `
                        <li class="flex items-center">
                            <input type="checkbox" id="check-${day}-${index}" class="checklist-item w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <label for="check-${day}-${index}" class="ml-3 text-gray-700 cursor-pointer">${item}</label>
                        </li>
                    `).join('')}
                </ul>
                
                <div class="mt-6 pt-4 border-t border-blue-200">
                    <h4 class="text-lg font-medium text-gray-700 mb-2">自己評価・メモ</h4>
                    <textarea id="self-eval-input" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" placeholder="今日の学習で感じたこと、次の課題などをメモしましょう..."></textarea>
                </div>
            </div>
        </div>
    `;

    let audioSourceToPlay = '';
    if (data.audio_sources) {
        audioSourceToPlay = data.audio_sources[currentAudioMode];
    } else if (data.audio_source) { // フォールバック
        audioSourceToPlay = data.audio_source;
    }

    initAudioPlayer(audioSourceToPlay);
    initDetailedExample(data.example_detailed);
    initChecklistAndPrompt(data);
};

// --- ( initAudioPlayer 関数 ) ---
const initAudioPlayer = (source) => {
    if (!source) {
        console.warn("Audio source is missing.");
        return;
    }
    mainAudio.src = source;
    mainAudio.load();
    mainAudio.playbackRate = 1.0;
    
    document.querySelectorAll('.main-speed-btn').forEach(b => {
        b.classList.remove('bg-indigo-100', 'text-indigo-600', 'font-bold', 'shadow-sm');
        b.classList.add('text-gray-600', 'hover:bg-indigo-50');
        if (b.dataset.speed === '1.0') {
            b.classList.add('bg-indigo-100', 'text-indigo-600', 'font-bold', 'shadow-sm');
        }
    });

    const playPauseBtn = document.getElementById('main-play-pause');
    const currentTimeEl = document.getElementById('main-current-time');
    const durationEl = document.getElementById('main-duration');
    const progressBarContainer = document.getElementById('main-progress-bar-container');
    const progressBarFill = document.getElementById('main-progress-bar-fill');
    const speedControls = document.querySelectorAll('.main-speed-btn');
    
    playPauseBtn.onclick = null;
    progressBarContainer.onclick = null;
    speedControls.forEach(btn => btn.onclick = null);

    mainAudio.onloadedmetadata = () => {
        durationEl.textContent = formatTime(mainAudio.duration);
        currentTimeEl.textContent = formatTime(mainAudio.currentTime);
    };

    mainAudio.ontimeupdate = () => {
        currentTimeEl.textContent = formatTime(mainAudio.currentTime);
        const progress = (mainAudio.currentTime / mainAudio.duration) * 100;
        progressBarFill.style.width = `${progress}%`;
    };
    
    mainAudio.onended = () => {
        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
    };

    playPauseBtn.onclick = () => {
        if (mainAudio.paused) {
            mainAudio.play();
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
        } else {
            mainAudio.pause();
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        }
    };

    progressBarContainer.onclick = (e) => {
        const rect = progressBarContainer.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const percentage = clickX / rect.width;
        mainAudio.currentTime = mainAudio.duration * percentage;
    };

    speedControls.forEach(btn => {
        btn.onclick = () => {
            const speed = parseFloat(btn.dataset.speed);
            mainAudio.playbackRate = speed;
            
            speedControls.forEach(b => {
                b.classList.remove('bg-indigo-100', 'text-indigo-600', 'font-bold', 'shadow-sm');
                b.classList.add('text-gray-600', 'hover:bg-indigo-50');
            });
            btn.classList.add('bg-indigo-100', 'text-indigo-600', 'font-bold', 'shadow-sm');
            btn.classList.remove('text-gray-600', 'hover:bg-indigo-50');
        };
    });
};

// --- ( initDetailedExample 関数 ) ---
const initDetailedExample = (detailedExamples) => {
    const select = document.getElementById('detailed-example-select');
    const exampleText = document.getElementById('detailed-example-text');
    
    if (detailedExamples && Object.keys(detailedExamples).length > 0) {
        if (select && exampleText) {
            select.onchange = (e) => {
                const key = e.target.value;
                exampleText.innerHTML = detailedExamples[key].replace(/\n/g, '<br>');
            };
        }
    }
};

// --- ( initChecklistAndPrompt 関数 ) ---
const initChecklistAndPrompt = (data) => {
    const checklistItems = document.querySelectorAll('.checklist-item');
    const generatePromptBtn = document.getElementById('generate-prompt');
    const copyPromptBtn = document.getElementById('copy-prompt');
    const userAnswerTextarea = document.getElementById('user-answer');
    const generatedPromptTextarea = document.getElementById('generated-prompt-text');
    const promptOutputDiv = document.getElementById('prompt-output');
    const selfEvalInput = document.getElementById('self-eval-input');

    const storedAnswer = localStorage.getItem(`answer_day_${currentDay}`);
    if (storedAnswer) userAnswerTextarea.value = storedAnswer;
    const storedEval = localStorage.getItem(`eval_day_${currentDay}`);
    if (storedEval) selfEvalInput.value = storedEval;
    
    checklistItems.forEach((item, index) => {
        const isChecked = localStorage.getItem(`checklist_day_${currentDay}_${index}`) === 'true';
        item.checked = isChecked;
        item.onchange = () => {
            localStorage.setItem(`checklist_day_${currentDay}_${index}`, item.checked);
            updateProgressBar();
        };
    });

    userAnswerTextarea.oninput = () => {
        localStorage.setItem(`answer_day_${currentDay}`, userAnswerTextarea.value);
    };
    selfEvalInput.oninput = () => {
        localStorage.setItem(`eval_day_${currentDay}`, selfEvalInput.value);
    };

    generatePromptBtn.onclick = () => {
        if (userAnswerTextarea.value.trim() === '') {
            if (currentAudioMode === 'kyarijii') {
                // alert('まずは君の回答を入力してみておくれ！');
                // 代替メッセージング
                const msg = currentAudioMode === 'kyarijii' ? 'まずは君の回答を入力してみておくれ！' : 'まずはあなたの回答を入力してください。';
                // 例: 簡素なメッセージボックス表示 (ここではalertの代替としてconsoleを使用)
                console.warn(msg); 
            } else {
                 // alert('まずはあなたの回答を入力してください。');
                console.warn('まずはあなたの回答を入力してください。'); 
            }
            return;
        }
        const prompt = `${data.prompt_focus}\n\n[質問内容]\n${data.title}\n\n[私の回答]\n${userAnswerTextarea.value.trim()}`;
        generatedPromptTextarea.value = prompt;
        promptOutputDiv.classList.remove('hidden');
    };

    copyPromptBtn.onclick = () => {
        generatedPromptTextarea.select();
        document.execCommand('copy');
        // alert('プロンプトがクリップボードにコピーされました!');
        // 代替メッセージング
        const copyMsg = 'プロンプトがクリップボードにコピーされました!';
        console.log(copyMsg);
    };
    
    updateProgressBar();
};

// --- ( updateNavigationMenuStatus 関数 ) ---
const updateNavigationMenuStatus = (dayCompletionStatus) => {
    const allListItems = document.querySelectorAll('aside ul li[data-day]');
    
    allListItems.forEach(li => {
        const day = parseInt(li.dataset.day);
        if (isNaN(day) || !dayCompletionStatus.has(day)) return;

        const percentage = dayCompletionStatus.get(day);
        
        let icon = li.querySelector('.completion-icon');
        
        if (percentage === 100) {
            li.classList.add('day-complete');
            if (!icon) {
                icon = document.createElement('i');
                icon.className = 'fas fa-check-circle completion-icon';
                li.prepend(icon);
            }
        } else {
            li.classList.remove('day-complete');
            if (icon) {
                icon.remove();
            }
        }
    });
};

// --- ( updateProgressBar 関数 ) ---
const updateProgressBar = () => {
    let completedDays = 0;
    let totalItems = 0;
    let completedItems = 0;
    const totalDays = 15;

    const dayCompletionStatus = new Map();

    for (let i = 1; i <= totalDays; i++) {
        if (!questionsData[i]) continue;

        const data = questionsData[i];
        const dayChecklistLength = data.checklist ? data.checklist.length : 0;
        let isDayComplete = true;
        let dayItemsComplete = 0;

        for (let j = 0; j < dayChecklistLength; j++) {
            totalItems++;
            if (localStorage.getItem(`checklist_day_${i}_${j}`) === 'true') {
                completedItems++;
                dayItemsComplete++;
            } else {
                isDayComplete = false;
            }
        }
        
        if (dayChecklistLength > 0) {
            dayCompletionStatus.set(i, (dayItemsComplete / dayChecklistLength) * 100);
        } else {
            dayCompletionStatus.set(i, 0); 
        }

        if (isDayComplete && dayChecklistLength > 0) {
            completedDays++;
        }
    }

    const progress = totalItems > 0 ? (completedItems / totalItems) * 100 : 0;
    progressBarFill.style.width = `${progress.toFixed(2)}%`;
    progressText.textContent = `${completedDays}/${totalDays} 日完了 (${completedItems}/${totalItems} 項目)`;

    const growthIcon = document.getElementById('growth-icon');
    const growthText = document.getElementById('growth-text');
    const progressPercent = document.getElementById('progress-percent');

    if (growthIcon && growthText && progressPercent) {
        progressPercent.textContent = progress.toFixed(0);

        if (progress === 0) {
            growthIcon.textContent = '🌱';
        } else if (progress > 0 && progress <= 25) {
            growthIcon.textContent = '🌱';
        } else if (progress > 25 && progress <= 50) {
            growthIcon.textContent = '🌳';
        } else if (progress > 50 && progress <= 99) {
            growthIcon.textContent = '🌸';
        } else if (progress >= 100) {
            growthIcon.textContent = '🍎';
        }
        
        if (currentAudioMode === 'kyarijii') {
            if (progress === 0) {
                growthText.textContent = '修行が始まったぞ！まずは種まきじゃ！';
            } else if (progress > 0 && progress <= 25) {
                growthText.textContent = 'おっ！芽が出たようじゃな！良い調子じゃ！';
            } else if (progress > 25 && progress <= 50) {
                growthText.textContent = '順調に育っておる！幹が太くなってきたぞ！';
            } else if (progress > 50 && progress <= 99) {
                growthText.textContent = 'おおー！見事な花が咲いたぞ！あともう一息じゃ！';
            } else if (progress >= 100) {
                growthText.textContent = '【皆伝】おめでとう！見事な実がなったぞ！完璧じゃ！';
            }
        } else {
            if (progress === 0) {
                growthText.textContent = '学習が開始されました。';
            } else if (progress > 0 && progress <= 25) {
                growthText.textContent = '学習が進んでいます。良い調子です。';
            } else if (progress > 25 && progress <= 50) {
                growthText.textContent = '順調です。プログラムの半分に到達しました。';
            } else if (progress > 50 && progress <= 99) {
                growthText.textContent = '素晴らしいです！あと少しで完了です。';
            } else if (progress >= 100) {
                growthText.textContent = '【完了】おめでとうございます！全ての項目を達成しました。';
            }
        }
    }

    updateNavigationMenuStatus(dayCompletionStatus);
};

// --- ( switchNavTab 関数 ) ---
const switchNavTab = (tabName) => {
    currentNavTab = tabName;

    if (tabName === 'daily') {
        tabDaily.classList.add('active');
        tabCategory.classList.remove('active');
        listDailyContainer.classList.remove('hidden');
        listCategoryContainer.classList.add('hidden');
        categoryFilterNav.classList.add('hidden');
    } else {
        tabDaily.classList.remove('active');
        tabCategory.classList.add('active');
        listDailyContainer.classList.add('hidden');
        listCategoryContainer.classList.remove('hidden');
        categoryFilterNav.classList.remove('hidden');
    }
    
    // Day 0 を選択中にタブを切り替えた場合の処理
    if (currentDay === 0) {
        if (tabName === 'category') {
            // 重要度別版に切り替えたら、Coreの最初の質問（Day 1）を表示
            renderDayContent(categories.core[0]);
        } else {
            // 日数別版に戻したら、Day 0（はじめに）を再表示
            renderDayContent(0);
        }
    } else {
        // Day 1以降を選択中にタブを切り替えたら、同じDayを再表示
        renderDayContent(currentDay);
    }
};

// --- ( イベントリスナー ) ---
document.querySelectorAll('#category-filter-nav .category-button').forEach(btn => {
    btn.addEventListener('click', () => {
        currentCategory = btn.dataset.category;
        if (categories[currentCategory] && categories[currentCategory].length > 0) {
            renderDayContent(categories[currentCategory][0]);
        }
    });
});

tabDaily.addEventListener('click', () => switchNavTab('daily'));
tabCategory.addEventListener('click', () => switchNavTab('category'));

[listDaily, lists.core, lists.key, lists.good].forEach(list => {
    list.addEventListener('click', (e) => {
        let target = e.target;
        while(target && target.tagName !== 'LI') {
            target = target.parentElement;
        }

        if (target && target.tagName === 'LI') {
            const day = parseInt(target.dataset.day);
            if (!isNaN(day)) {
                renderDayContent(day);
            }
        }
    });
});

// --- ( リセット機能の追加 ) ---
const resetData = () => {
    // ユーザーに確認を求める（alertは使用できないため、console.logで代替）
    console.log("★★★★ 進捗データを完全にリセットしますか？ ★★★★");
    console.log("この操作は元に戻せません。");
    // 実際のアプリケーションではカスタムモーダルを使用すべき。ここでは簡略化のため直接localStorageを操作。
    
    // localStorage内の進捗関連データをすべて削除
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        // 回答、チェックリスト、評価メモに関連するキーをターゲットに絞る
        if (key.startsWith('answer_day_') || key.startsWith('checklist_day_') || key.startsWith('eval_day_')) {
            localStorage.removeItem(key);
            // iをデクリメントしてループのキーインデックスずれを防ぐ
            i--; 
        }
    }

    // 成功メッセージを表示（コンソール）
    console.log("進捗データがリセットされました。ページをリロードします。");

    // ページをリロードして初期状態に戻す
    window.location.reload();
};


// --- ( DOMContentLoaded イベント ) ---
document.addEventListener('DOMContentLoaded', () => {
    
    const modal = document.getElementById('mode-select-modal');
    const selectKyarijii = document.getElementById('select-kyarijii');
    const selectNormal = document.getElementById('select-normal');
    const introAudio = document.getElementById('intro-audio');
    const mainTitle = document.querySelector('header h1');
    const mainSubtitle = document.querySelector('header p');
    const audioWarning = document.getElementById('audio-warning');
    
    // ★★★【追加】実践練習モードのDOM要素をここで取得 ★★★
    startPracticeBtn = document.getElementById('start-practice-mode');
    practiceModal = document.getElementById('practice-modal');
    practiceQuestionCount = document.getElementById('practice-question-count');
    practiceQuestionTitle = document.getElementById('practice-question-title');
    practiceTimer = document.getElementById('practice-timer');
    practiceTimerBar = document.getElementById('practice-timer-bar');
    stopPracticeBtn = document.getElementById('stop-practice');
    nextPracticeBtn = document.getElementById('next-practice-question');
    // ★★★ ここまで ★★★

    // リセットボタンのイベントリスナーを追加
    const resetButton = document.getElementById('reset-data-button');
    if (resetButton) {
        resetButton.addEventListener('click', resetData);
    }
    

    const initializeApp = (mode) => {
        currentAudioMode = mode;
        
        const introSrc = questionsData[0].audio_sources[mode];
        if (introSrc) {
            introAudio.src = introSrc;
            introAudio.load();
        } else {
            console.warn("Intro audio source is missing for mode:", mode);
        }

        const practiceDescription = document.getElementById('practice-description'); // ★追加

        if (mode === 'kyarijii') {
            mainTitle.textContent = 'キャリ爺の面接道場';
            mainSubtitle.textContent = '15日間の修行で、最強の面接スキルを手に入れるんじゃ！';
            audioWarning.textContent = '★注意★各日程の音声ガイドを再生する場合は、この説明音声をstopするんじゃぞ。★';
            audioWarning.classList.remove('hidden');
            practiceDescription.textContent = '準備ができたら、ランダムな質問（全3問）で本番の練習をするんじゃ！'; // ★追加
        } else {
            mainTitle.textContent = '面接対策 15日間プログラム';
            mainSubtitle.textContent = '15日間の学習で、面接スキルを習得しましょう。';
            audioWarning.textContent = '★注意★各日程の音声ガイドを再生する場合は、この説明音声をstopしてください。★';
            audioWarning.classList.remove('hidden');
            practiceDescription.textContent = '準備ができたら、ランダムな質問（全3問）で本番の練習をしてください。'; // ★追加
            document.body.classList.add('normal-mode');
        }

        modal.style.display = 'none';

        renderQuestionsList();
        switchNavTab('daily'); // これが renderDayContent(0) を呼び出す
        updateProgressBar();
        initIntroAudioPlayer();
        
        // ★★★【追加】実践練習モードのイベントリスナーを登録 ★★★
        startPracticeBtn.addEventListener('click', startPracticeMode);
        stopPracticeBtn.addEventListener('click', stopPracticeMode);
        nextPracticeBtn.addEventListener('click', handleNextPracticeClick);
        // ★★★ ここまで ★★★
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed', err));
            });
        }
        
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            const installBtn = document.createElement('button');
            installBtn.textContent = 'アプリをインストール';
            installBtn.className = 'fixed bottom-4 right-4 bg-indigo-600 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-indigo-700 transition z-50';
            installBtn.onclick = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    deferredPrompt = null;
                    installBtn.remove();
                }
            };
            document.body.appendChild(installBtn);
        });
    };

    selectKyarijii.addEventListener('click', () => initializeApp('kyarijii'));
    selectNormal.addEventListener('click', () => initializeApp('normal'));
});

// --- ( renderQuestionsList 関数 ) ---
const renderQuestionsList = () => {
    listDaily.innerHTML = '';
    // Day 0 を除外
    for (let i = 1; i <= 15; i++) {
        if (!questionsData[i]) continue;
        const listItem = document.createElement('li');
        listItem.textContent = questionsData[i].title;
        listItem.dataset.day = i;
        listDaily.appendChild(listItem);
    }

    for (const category in lists) {
        lists[category].innerHTML = '';
        categories[category].forEach(day => {
            if (!questionsData[day]) return;
            const listItem = document.createElement('li');
            listItem.textContent = questionsData[day].title;
            listItem.dataset.day = day;
            lists[category].appendChild(listItem);
        });
    }
};

// --- ( initIntroAudioPlayer 関数 ) ---
const initIntroAudioPlayer = () => {
    const playIntroBtn = document.getElementById('play-intro');
    const introAudio = document.getElementById('intro-audio');
    const introSpeedControls = document.querySelectorAll('#intro-speed-controls .speed-btn');

    if (playIntroBtn && introAudio) {
        playIntroBtn.addEventListener('click', () => {
            if (introAudio.paused) {
                introAudio.play();
                playIntroBtn.innerHTML = '<i class="fas fa-pause"></i>';
            } else {
                introAudio.pause();
                playIntroBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        });
        
        introAudio.onended = () => {
            playIntroBtn.innerHTML = '<i class="fas fa-play"></i>';
        };

        introSpeedControls.forEach(btn => {
            btn.addEventListener('click', () => {
                const speed = parseFloat(btn.dataset.speed);
                introAudio.playbackRate = speed;
                
                introSpeedControls.forEach(b => {
                    b.classList.remove('bg-white', 'text-indigo-600', 'font-bold', 'shadow-sm');
                    b.classList.add('text-gray-600', 'hover:bg-white');
                });
                btn.classList.add('bg-white', 'text-indigo-600', 'font-bold', 'shadow-sm');
                btn.classList.remove('text-gray-600', 'hover:bg-white');
            });
        });
    }
};

// ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★
// ★★★【以下に、実践練習モード用の関数を丸ごと追加】★★★
// ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★

/**
 * Web Audio APIを使用して短いビープ音を鳴らす
 */
const playBeep = () => {
    // AudioContextが中断されている場合は再開を試みる (ユーザー操作後にのみ可能)
    if (audioContext.state === 'suspended') {
        audioContext.resume().catch(e => console.error("AudioContext resume failed:", e));
    }

    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();

    // 周波数と波形を設定 (短い電子音に最適な設定)
    oscillator.type = 'sine'; // サイン波 (正弦波) を使用
    oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // 440Hz (A4)

    // ゲインを設定 (音量調整)
    gainNode.gain.setValueAtTime(0.5, audioContext.currentTime); // 初期音量を0.5に設定
    // フェードアウト
    gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + 0.3); // 0.3秒かけてフェードアウト

    // 接続: オシレーター -> ゲイン -> 出力
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);

    // 再生開始と停止
    oscillator.start();
    oscillator.stop(audioContext.currentTime + 0.3); // 0.3秒後に停止
};

/**
 * 配列をシャッフルする（Fisher-Yatesアルゴリズム）
 */
const shuffleArray = (array) => {
    let newArr = [...array]; // 元の配列を変更しない
    for (let i = newArr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
    }
    return newArr;
};

/**
 * 練習モードを開始する
 */
const startPracticeMode = () => {
    // 動作中の音声をすべて停止
    const introAudio = document.getElementById('intro-audio');
    const mainAudio = document.getElementById('main-audio');
    introAudio.pause();
    mainAudio.pause();
    document.getElementById('play-intro').innerHTML = '<i class="fas fa-play"></i>';
    // Day 0 以外が選択されていたら、その再生ボタンもリセット
    const mainPlayPauseBtn = document.getElementById('main-play-pause');
    if (mainPlayPauseBtn) {
        mainPlayPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
    }

    // 質問を3問ランダムに選ぶ
    practiceQuestions = shuffleArray(practiceQuestionPool).slice(0, 3);
    currentPracticeIndex = 0;
    
    // 最初の質問を表示
    showPracticeQuestion();
    
    // モーダルを表示
    practiceModal.classList.remove('hidden');
    
    // AudioContextを起動（最初のユーザー操作をトリガーとする）
    if (audioContext.state === 'suspended') {
        audioContext.resume().catch(e => console.error("AudioContext resume failed:", e));
    }
};

/**
 * 練習モードを中断・終了する
 */
const stopPracticeMode = () => {
    // タイマーを停止
    clearInterval(practiceTimerInterval);
    practiceTimerInterval = null;
    
    // モーダルを非表示
    practiceModal.classList.add('hidden');
    
    // 変数をリセット
    practiceQuestions = [];
    currentPracticeIndex = 0;
};

/**
 * モーダルに現在の質問を表示する
 */
const showPracticeQuestion = () => {
    // タイマーが動いていれば止める
    clearInterval(practiceTimerInterval);
    practiceTimerInterval = null;

    // 質問データを取得
    const day = practiceQuestions[currentPracticeIndex];
    const data = questionsData[day];
    
    // テキストを更新
    practiceQuestionCount.textContent = `第 ${currentPracticeIndex + 1} 問 / ${practiceQuestions.length} 問`;
    practiceQuestionTitle.textContent = data.title;
    
    // タイマーUIをリセット
    practiceTimerSeconds = 60;
    practiceTimer.textContent = formatTime(practiceTimerSeconds); // formatTimeは既存の関数を使用
    practiceTimer.classList.remove('text-red-500');
    practiceTimerBar.style.width = '100%';
    practiceTimerBar.classList.remove('bg-red-500');
    practiceTimerBar.classList.add('bg-blue-500');
    
    // ボタンのテキストをリセット
    nextPracticeBtn.textContent = 'タイマースタート';
    nextPracticeBtn.disabled = false; // ボタンを有効化
};

/**
 * 「タイマースタート / 次の質問へ」ボタンが押された時の処理
 */
const handleNextPracticeClick = () => {
    const btnState = nextPracticeBtn.textContent;
    
    if (btnState === 'タイマースタート') {
        // タイマーを開始する
        startPracticeTimer();
        
        // ボタンのテキストを変更
        if (currentPracticeIndex < practiceQuestions.length - 1) {
            nextPracticeBtn.textContent = '次の質問へ';
        } else {
            nextPracticeBtn.textContent = '練習を終了する';
        }
        
    } else if (btnState === '次の質問へ') {
        // 次の質問へ進む
        currentPracticeIndex++;
        showPracticeQuestion();
        
    } else if (btnState === '練習を終了する') {
        // 練習を終了する
        stopPracticeMode();
    }
};

/**
 * 60秒タイマーを開始する
 */
const startPracticeTimer = () => {
    // 念のため既存のタイマーをクリア
    clearInterval(practiceTimerInterval);
    
    practiceTimerSeconds = 60; // 60秒にリセット
    
    practiceTimerInterval = setInterval(() => {
        practiceTimerSeconds--;
        
        // タイマーテキストを更新
        practiceTimer.textContent = formatTime(practiceTimerSeconds);
        
        // タイマーバーを更新
        practiceTimerBar.style.width = (practiceTimerSeconds / 60) * 100 + '%';
        
        // 10秒以下になったら赤くする
        if (practiceTimerSeconds <= 10) {
            practiceTimer.classList.add('text-red-500');
            practiceTimerBar.classList.remove('bg-blue-500');
            practiceTimerBar.classList.add('bg-red-500');
        }
        
        // 0秒になったら停止
        if (practiceTimerSeconds <= 0) {
            clearInterval(practiceTimerInterval);
            practiceTimerInterval = null;
            
            // アラート音を再生（Web Audio APIによるビープ音に変更）
            playBeep();
            
            // タイムアップを通知（キャリ爺モードか通常モードかで文言変更）
            if (currentAudioMode === 'kyarijii') {
                // alert('時間じゃ！ 次の質問へ進むんじゃぞ！'); // alertは使わない
                nextPracticeBtn.disabled = false; // ボタンを再度有効化
            } else {
                // alert('時間です。次の質問へ進んでください。'); // alertは使わない
                nextPracticeBtn.disabled = false; // ボタンを再度有効化
            }
            
            // タイムアップを伝えるメッセージを代わりに表示することも検討するが、今回はシンプルにボタンを有効化するだけに留める。
        }
        
    }, 1000); // 1秒ごとに実行
};
// ★★★【実践練習モード用の関数はここまで】 ★★★

</script>

<div id="practice-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex justify-center items-center z-50 hidden">
    <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-2xl max-w-2xl w-full mx-4 text-center">
        
        <div id="practice-content">
            <h3 class="text-lg font-semibold text-gray-500" id="practice-question-count">第 1 問 / 3 問</h3>
            <h2 class="text-2xl sm:text-3xl font-bold text-indigo-700 my-6" id="practice-question-title">（質問タイトル）</h2>
        </div>
        
        <div class="my-6 sm:my-8">
            <p class="text-gray-600 mb-2">回答時間（目安: 60秒）</p>
            <div class="text-5xl sm:text-6xl font-bold text-gray-800" id="practice-timer">
                01:00
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2.5 mt-4">
                <div id="practice-timer-bar" class="bg-blue-500 h-2.5 rounded-full transition-all duration-1000" style="width: 100%"></div>
            </div>
        </div>
        
        <div class="flex justify-between items-center mt-8 sm:mt-10">
            <button id="stop-practice" class="text-gray-500 hover:text-gray-700 font-medium px-2 py-2">
                練習を中断する
            </button>
            <button id="next-practice-question" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 sm:px-8 rounded-lg transition shadow-md text-lg">
                タイマースタート
            </button>
        </div>
    </div>
</div>
</body>
</html>